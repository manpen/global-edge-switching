
benchmark_executable="$1"

bench_dir="benchmark-results"
if ! test -d "$bench_dir"
then
 mkdir "$bench_dir"
fi
if ! test -d "$bench_dir/real-world" ; then
 mkdir "$bench_dir/real-world"
fi

p=32
spe=10
repeats=5

for algo in "robin" "naive" "global-naive" "global" "global-no-wait" ; do
 graph_dir="/data/networks/network-repository.com"
 for category in "$graph_dir"/* ; do
  if test -d "$category" ; then
   category_name="$(basename $category)"
   if ! test -d "$bench_dir/real-world/$category_name" ; then
    mkdir "$bench_dir/real-world/$category_name"
   fi
   for graph in "$graph_dir/$category_name"/* ; do
    if test -d "$graph" ; then
     graph_name="$(basename $graph)"
     echo "Benchmarking $algo on $graph_name"
     graph_edges="$graph_dir/$category_name/$graph_name/""$graph_name.simp-undir-edges"
     bench_file="$bench_dir/real-world/$category_name/""$graph_name""_""$algo""_""$spe""_""$p"
     "$benchmark_executable" bench "$graph_edges" "$p" "$repeats" "$algo" "$spe" verbose >> "$bench_file"
    fi
   done
  fi
 done
done